
Context for PR #3264933329
Primary language: Python

PR title:
Fix: Wait for all partitions in load_collection when some are still loading

PR body:
## Summary

Fixes an issue where `load_collection` would return success when collection progress reached 100%, even if individual partitions were still loading after being released and reloaded.

### Problem
When executing this sequence on a collection with multiple partitions (PartA, PartB, PartC):
1. `load_collection` - loads entire collection
2. `release_partition('partA')` - releases partA  
3. `load_collection` - loads collection again

The third step would detect the released partA and sta
...
 checking logic 
- [x] Verified backward compatibility
- [x] Tested timeout handling for stuck partitions
- [x] Verified both sync and async implementations
- [x] Confirmed integration with collection loading flow
- [x] All tests passing (12/12)
- [x] Code passes lint checks

Fixes scenario: `load collection` â†’ `release partA` â†’ `load collection` where partA data would be missing from queries.

ðŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

Diff summary:
pymilvus/client/async_grpc_handler.py
@@ -275,6 +275,10 @@ async def load_collection(
         await self.ensure_channel_ready()
 
         check_pass_param(timeout=timeout)
+
+        # Get all partition names before LoadCollection call 
...
     return
             await asyncio.sleep(Config.WaitTimeDurationWhenLoad)
         raise MilvusException(
             message=f"wait for loading collection timeout, collection: {collection_name}"
pymilvus/client/grpc_handler.py
@@ -1315,6 +1315,9 @@ def load_collection(
     ):
         check_pass_param(timeout=timeout)
 
+        # Get all partition names before LoadCollection call to avoid race conditions
+        partitio
...
              return
             time.sleep(Config.WaitTimeDurationWhenLoad)
         raise MilvusException(
             message=f"wait for loading collection timeout, collection: {collection_name}"
tests/test_load_collection_unit.py
@@ -0,0 +1,343 @@
+"""
+Unit tests for load_collection partition loading fix.
+These tests focus on the logic without requiring grpc_testing dependencies.
+"""
+import pytest
+import asyncio
+from uni
...
of calls
+        expected_order = ['ensure_channel_ready', 'list_partitions', 'LoadCollection', 'wait_for_loading_collection']
+        assert call_order == expected_order
\ No newline at end of file

First failing CI snippet:


Top review comments:
[APPROVALNOTIFIER] This PR is **NOT APPROVED**

This pull-request has been approved by: *<a href="https://github.com/milvus-io/pymilvus/pull/2911#" title="Author self-approved">weiliu1031</a>*
To complete the [pull request process](https://git.k8s.io/community/contributors/guide/owners.md#the-code-review-process), please assign **xuanyang-cn** after the PR has been reviewed.
You can assign the PR to them by writing `/assign @xuanyang-cn` in a comment when ready.

The full list of commands accepted by this bot can be found [here](https://go.k8s.io/bot-commands?repo=milvus-io%2Fpymilvus).

<details open>
Needs approval from an approver in each of these files:

- **[OWNERS](https://github.com/milvus-io/pymilvus/blob/master/OWNERS)**

Approvers can indicate their approval by writing `/approve` in a comment
Approvers can cancel approval by writing `/approve cancel` in a comment
</details>
<!-- META={"approvers":["xuanyang-cn"]} -->
---
/hold

Commit messages (for context):
fix: Wait for all partitions in load_collection when some are still loading

When load_collection is called on a collection where some partitions were
previously released, the SDK should wait for all partitions to be fully
loaded before returning success. Previously, it would return when collection
progress reached 100% even if individual partitions were still loading.

Changes:
- Get partition list before LoadCollection RPC to avoid race conditions
- Add partition_names parameter to wait_for_lo
...
ck individual partition LoadState when collection progress is 100%
- Apply fix to both sync and async grpc handlers
- Maintain backward compatibility when partition_names is None
- Add comprehensive unit tests for the new functionality

Fixes scenario: load collection -> release partA -> load collection
where partA data would be missing from queries.

ðŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
Signed-off-by: Wei Liu <wei.liu@zilliz.com>
